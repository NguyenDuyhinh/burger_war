<launch>
  <!-- オドメトリを代替して精度を上げるランチファイル -->

  <!-- 手法1: IMU, オドメトリをカルマンフィルタで合成 -->
  <node pkg="robot_localization" type="ekf_localization_node" name="ekf_se" clear_params="true">
    <rosparam command="load" file="$(find wp_navigation)/param/ekf_template.yaml" />
    <remap from="odometry/filtered" to="odom2"/>
  </node>

  <!-- 手法2:スキャンマッチでオドメトリを生成 -->
  <!-- <node pkg="laser_scan_matcher" type="laser_scan_matcher_node" name="laser_scan_matcher_node" output="screen">
    <remap from="scan" to="scan2"/>
    <remap from="imu/data" to="imu"/>
    <param name="use_imu" value="false"/>
    <param name="use_odom" value="false"/>
    <param name="fixed_frame" value="odom"/>
    <param name="base_frame" value="base_footprint2"/>
    <param name="max_iterations" value="10"/>
    <param name="max_correspondence_dist" value="0.3"/>
    <param name="max_angular_correction_deg" value="10"/>
    <param name="max_linear_correction" value="0.2"/>
    <param name="clustering_threshold" value="0.1"/>
  </node> -->

  <!-- 新しいTFツリーの出力 -->
  <node pkg="tf2_ros" type="static_transform_publisher" args="0 0 0 0 0 0 base_footprint2 base_link2" name="tf_base2"/>
  <node pkg="tf2_ros" type="static_transform_publisher" args="-0.032 0 0.068 0 0 0 base_link2 imu_link2" name="tf_imu2"/>
  <node pkg="tf2_ros" type="static_transform_publisher" args="0 0 0 0 0 0 base_link2 base_scan2" name="tf_scan2"/>

  <!-- 新しいTFツリーへscanトピックをコピー -->
  <node pkg="wp_navigation" type="copy_scan.py" name="copy_scan"/>
</launch>

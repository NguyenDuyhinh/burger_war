<?xml version="1.0"?>
<launch>
  <arg name="robot_name" default="red_bot"/>

  <!-- LRFのスキャンマッチングでオドメトリ値を出すための処理 -->
  <node pkg="tf2_ros" type="static_transform_publisher" args="0 0 0 0 0 0 $(arg robot_name)/base_link_scanmatch $(arg robot_name)/laser2" name="$(anon tf_scanmatch)"/>
  <!-- <node pkg="tf2_ros" type="static_transform_publisher" args="0 0 0 3.1415 0 0 $(arg robot_name)/base_link_scanmatch $(arg robot_name)/laser2" name="$(anon tf_scanmatch)"/> -->
  <node pkg="wp_navigation" type="copy_scan.py" name="$(anon copy_scan)">
    <param name="robot_name" value="$(arg robot_name)"/>
  </node>
  <!-- スキャンマッチャーの起動 -->
  <node pkg="laser_scan_matcher" type="laser_scan_matcher_node" name="$(anon laser_scan_matcher_node)" output="screen">
    <remap from="scan" to="scan2"/>
    <remap from="imu/data" to="imu"/>
    <!-- <remap from="scan" to="/red_bot/scan"/> -->
    <param name="use_imu" value="false"/>
    <param name="use_odom" value="true"/>
    <param name="outliers_maxPerc" value="0.9"/>
    <param name="fixed_frame" value="$(arg robot_name)/odom_scanmatch"/>
    <param name="base_frame" value="$(arg robot_name)/base_link_scanmatch"/>
    <!-- <param name="base_frame" value="red_bot/odom"/> -->
    <param name="max_iterations" value="10"/>
  </node>

  <!-- move_baseの起動 -->
  <include file="$(find burger_navigation)/launch/burger_navigation.launch">
    <arg name="robot_name" value="$(arg robot_name)" />
    <arg name="odom_topic" value="odom_scanmatch" />
    <arg name="scan_topic" value="scan2" />
    <arg name="odom_frame_id" value="odom_scanmatch"/>
    <arg name="base_frame_id" value="base_link_scanmatch"/>
  </include>

  <!-- ウェイポイント送信ノードの起動 -->
  <node pkg="wp_navigation" type="wp_navigation" name="$(anon wp_navigation)" launch-prefix="xterm -font r16 -bg blue -e">
    <param name="robot_name" value="$(arg robot_name)"/>
  </node>
</launch>
